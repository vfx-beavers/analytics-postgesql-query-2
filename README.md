# Задача
Сделать отчёт/выгрузку, как в приложенном шаблоне xlsx.

Для выделенных строк основной период промо N будет 09.02.23-23.02.23. 
Помимо атрибутов самой промоакции, в отчёт надо вывести посчитанные метрики:
- за период N-1 (29.12.22-11.01.23) - колонки M-R в шаблоне
- период N-2 (15.12.22-28.12.22) - колонки S-V 
- за 7-дневный период перед текущим/будущим промо (02.02.23-08.02.23) - колонки J-L.
Интересуют метрики (цена, продажи в руб, в шт, кол-во дней без продаж, и т.д.) по промо-периодам и вне промо за последние 7 дней.

# Приложенные материалы:

test_sales.csv - данные о фактических продажах
OBJECT_BK - id магазина
PRODUCT_CODE - артикул
F_SALE_DT - дата продажи
F_SALE_AMT - сумма продаж
F_SALE_AMT_NOVAT - сумма без НДС
F_SALE_QTY - количество

test_promo_fact1.csv - основной справочник промоакций
PROMO_ACTION_HK - id промоакции
OBJECT_BK - id магазина
START_DT - начало периода промо
END_DT- конец периода промо
SEGMENT_BK - сегмент артикула
PRODUCT_CODE - артикул
SALE_PRICE - цена
PROMO_ORD_CONF_QTY - подтверждённое кол-во

test_promo_lookup.csv - вспомогательный справочник промоакций
PROMO_ACTION_HK - id промоакции
PROMO_ACTION_NAME  - имя промо
PROMO_ACTION_TYPE_NAME - тип промо
PROMO_PERIOD_TYPE_DESCRIPTION - название периода
PLACE_TYPE - тип места

Шаблон отчета.xlsx - пример желаемого результата выборки.

# Пояснение
'N-1' - предыдущий период промо перед выбранным, 'N-2' период перед этим.

#Список файлов в порядке очерёдности запуска:
0_import_csv.py - импорт, приведение типов и экспорт в промежуточные csv
1_ddl.sql - создание и заполнение таблиц
2_sql_query_assemble.sql - формирование колонок
3_dml.sql - выгрузка в сводную таблицу
4_export_exel.py - переименование итоговых столбцов и выгрузка в exel
db_and_views_backup-de - слепок db и view для проверки
docker.txt - строка для тестового докера

# Среда
docker run -d -p 15432:5432 --name=de-ashan-test -e POSTGRES_USER=pguser -e POSTGRES_PASSWORD=pgpwd -e POSTGRES_DB=de -d postgres:13
